

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Ambiguities in the Hanle effect in the saturation regime &mdash; Hazel 2.0beta1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Hazel 2.0beta1 documentation" href="index.html"/>
        <link rel="next" title="The reference system" href="refsys.html"/>
        <link rel="prev" title="Basic Equations" href="equations.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Hazel
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="programmatically.html">Programmatically</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputOutput.html">Input/output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="prepareData.html">Data preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="equations.html">Basic Equations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Ambiguities in the Hanle effect in the saturation regime</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1"><span class="math">\(\Phi_B’=\Phi_B\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2"><span class="math">\(\Phi_B’=\Phi_B+\pi\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3"><span class="math">\(\Phi_B’=\Phi_B+\pi/2\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4"><span class="math">\(\Phi_B’=\Phi_B-\pi/2\)</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="refsys.html">The reference system</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="disclaimer.html">Disclaimer</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Hazel</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Ambiguities in the Hanle effect in the saturation regime</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/ambiguities.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ambiguities-in-the-hanle-effect-in-the-saturation-regime">
<h1>Ambiguities in the Hanle effect in the saturation regime<a class="headerlink" href="#ambiguities-in-the-hanle-effect-in-the-saturation-regime" title="Permalink to this headline">¶</a></h1>
<p>In the saturation regime of the Hanle effect, Stokes <span class="math">\(Q\)</span> and
<span class="math">\(U\)</span> are insensitive to the field strength, but are sensitive to
the geometry of the field. For a <span class="math">\(J=0 \to J=1\)</span> transition, the
linear polarization can be written as:</p>
<div class="math">
\[\begin{split}\begin{aligned}
Q &amp;=&amp; \frac{q}{2} \left( 3 \cos^2 \theta_B-1 \right) \sin^2\Theta_B \cos 2\Phi_B \nonumber \\
U &amp;=&amp; \frac{q}{2} \left( 3 \cos^2 \theta_B-1 \right) \sin^2\Theta_B \sin 2\Phi_B.\end{aligned}\end{split}\]</div>
<p>These expressions contain a mixture of angles to make it clear that the
polarization amplitude depends on both the angle between the vertical
and the magnetic field and between the magnetic field and the
line-of-sight (LOS).</p>
<p>The coordinates of the magnetic field vector <span class="math">\(\mathbf{B}\)</span> in the
reference system of the vertical and the reference system of the LOS
are:</p>
<div class="math">
\[\begin{split}\begin{aligned}
\mathbf{B} &amp;=&amp; B \left(\sin \theta_B \cos \phi_B \mathbf{i}+\sin \theta_B \sin \phi_B \mathbf{j}+\cos \theta_B \mathbf{k} \right) \nonumber \\
\mathbf{B} &amp;=&amp; B \left(\sin \Theta_B \cos \Phi_B \mathbf{i}'+\sin \Theta_B \sin \Phi_B \mathbf{j}'+\cos \Theta_B \mathbf{k}' \right),\end{aligned}\end{split}\]</div>
<p>where the unit vectors are related by a simple rotation:</p>
<div class="math">
\[\begin{split}\begin{aligned}
\mathbf{i}' &amp;=&amp; \cos \theta \mathbf{i} - \sin \theta \mathbf{k} \nonumber \\
\mathbf{k}' &amp;=&amp; \sin \theta \mathbf{i} + \cos \theta \mathbf{k}.\end{aligned}\end{split}\]</div>
<p>Introducing these relations on the expression for the magnetic field,
we find that the following has to be fulfilled, given that the magnetic
field vector is the same in both reference systems:</p>
<div class="math">
\[\begin{split}\begin{aligned}
\sin \theta_B \cos \phi_B &amp;=&amp; \sin \Theta_B \cos \Phi_B \cos \theta + \cos \Theta_B + \sin \theta \nonumber \\
\sin \theta_B \sin \phi_B &amp;=&amp; \sin \Theta_B \sin \Phi_B \nonumber \\
\cos \theta_B &amp;=&amp; \cos \Theta_B \cos \theta - \sin \Theta_B \cos \Phi_B \sin \theta.\end{aligned}\end{split}\]</div>
<p>Solving the previous three equations in the two directions, we find the
following transformations between the angles in the vertical reference
system and the LOS reference system:</p>
<div class="math">
\[ \begin{align}\begin{aligned}\begin{split}  \begin{aligned}
  \cos \Theta_B &amp;=&amp; \cos\theta \cos\theta_B + \sin\theta \sin\theta_B \cos\phi_B \nonumber \\
  \sin \Theta_B &amp;=&amp; +\sqrt{1-\cos^2\Theta_B} \nonumber \\
  \cos \Phi_B &amp;=&amp; \frac{\cos\theta \sin\theta_B \cos\phi_B - \cos\theta_B \sin\theta}{\sin \Theta_B} \nonumber \\
  \sin \Phi_B &amp;=&amp; \frac{\sin\theta_B \sin\phi_B}{\sin\Theta_B}\end{aligned}\end{split}\\and\end{aligned}\end{align} \]</div>
<div class="math">
\[\begin{split}\begin{aligned}
\cos \theta_B &amp;=&amp; \cos\theta \cos\Theta_B - \sin\theta \sin\Theta_B \cos\Phi_B \nonumber \\
\sin \theta_B &amp;=&amp; +\sqrt{1-\cos^2\theta_B} \nonumber \\
\cos \phi_B &amp;=&amp; \frac{\cos\theta \sin\Theta_B \cos\Phi_B + \cos\Theta_B \sin\theta}{\sin \theta_B} \nonumber \\
\sin \phi_B &amp;=&amp; \frac{\sin\Theta_B \sin\Phi_B}{\sin\theta_B}.\end{aligned}\end{split}\]</div>
<p>Note that, since <span class="math">\(\Theta_B \in [0,\pi]\)</span>, we can safely use the
square root and take the positive value. In order to transform from one
reference system to the other, we can compute the inclination easily by
inverting the sinus or the cosinus. However, the situation is different
for the azimuth, because the range of variation is <span class="math">\([-\pi,\pi]\)</span>.
Therefore, one has to compute the cosinus and the sinus separately and
the decide which is the correct quadrant fo the angle in terms of the
signs of both quantities.</p>
<p>Four possible kinds of ambiguities can exist for the Stokes <span class="math">\(Q\)</span>
and <span class="math">\(U\)</span> parameters. The idea is that <span class="math">\(\Phi_B\)</span> can be
modified and still obtain the same <span class="math">\(Q\)</span> and <span class="math">\(U\)</span> by properly
adjusting the value of <span class="math">\(\Theta_B\)</span>. It is clear that, given that
the term that can be used to compensate for the change in the azimuth on
the LOS reference system is the same for Stokes <span class="math">\(Q\)</span> and <span class="math">\(U\)</span>,
we can only compensate for changes in the sign. Therefore, we have the
following potential ambiguities:</p>
<div class="math">
\[\begin{split}\begin{aligned}
\Phi_B' &amp;=&amp; \Phi_B \nonumber \\
\Phi_B' &amp;=&amp; \Phi_B -\pi/2 \nonumber \\
\Phi_B' &amp;=&amp; \Phi_B + \pi/2 \nonumber \\
\Phi_B' &amp;=&amp; \Phi_B + \pi.\end{aligned}\end{split}\]</div>
<p>For each case, we have to compute the value of <span class="math">\(\Theta_B'\)</span> that
keeps the value of <span class="math">\(Q\)</span> and <span class="math">\(U\)</span> unchanged. Therefore, once we
find a solution to the inversion problem in the form of the pair
<span class="math">\((\theta_B,\phi_B)\)</span>, we can find the remaining solutions in the
saturation regime following the recipes that we present now. Remember
that, unless one knows the polarity of the field, or in other words, the
sign <span class="math">\(\cos\Theta_B\)</span>, the number of potential ambiguous solutions
is 8. If the polarity of the field is known, the number is typically
reduced to 4 (or 2 if no 90<span class="math">\(^\circ\)</span> ambiguity is present).</p>
<div class="section" id="id1">
<h2><span class="math">\(\Phi_B’=\Phi_B\)</span><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Under this change, we have that</p>
<div class="math">
\[ \begin{align}\begin{aligned}\cos 2\Phi_B' = \cos 2\Phi_B, \quad \sin 2\Phi_B' = \sin 2\Phi_B, \quad \cos \Phi_B' = \cos \Phi_B, \quad \sin \Phi_B' = \sin \Phi_B.\\Making use of the previous relations between the angles wrt to the\end{aligned}\end{align} \]</div>
<p>vertical and the LOS, we have to solve the following equation:</p>
<div class="math">
\[ \begin{align}\begin{aligned}\left( 3 \cos^2\theta_B'-1 \right) \sin^2 \Theta_B' = \left( 3 \cos^2\theta_B-1 \right) \sin^2 \Theta_B,\\which can be written as:\end{aligned}\end{align} \]</div>
<div class="math">
\[\left[ 3 \left( \cos \Theta_B' \cos \theta - \sin\theta \sin\Theta_B' \cos\Phi_B\right)^2-1 \right] \sin^2 \Theta_B' =
\left[ 3 \left( \cos \Theta_B \cos \theta - \sin\theta \sin\Theta_B \cos\Phi_B\right)^2-1 \right] \sin^2 \Theta_B.\]</div>
<p>After some algebra and doing the substitution <span class="math">\(t=\sin\Theta_B'\)</span>,
we end up with the following equation to be solved:</p>
<div class="math">
\[A t^4 + Bt^2 + C t^3 \sqrt{1-t^2} = K,\]</div>
<p>where</p>
<div class="math">
\[\begin{split}\begin{aligned}
A &amp;=&amp; -3\cos^2 \theta + 3\sin^2 \theta \cos^2 \Phi_B \nonumber \\
B &amp;=&amp; 3\cos^2 \theta - 1 \nonumber \\
C &amp;=&amp; -6 \cos\theta \sin\theta \cos \Phi_B \nonumber \\
K &amp;=&amp; \left[ 3 \left( \cos \Theta_B \cos \theta - \sin\theta \sin\Theta_B \cos\Phi_B\right)^2-1 \right] \sin^2 \Theta_B.\end{aligned}\end{split}\]</div>
<p>The previous equation can be solved if we make the change of variables
<span class="math">\(t=\pm \sqrt{Z}\)</span>, resulting in:</p>
<div class="math">
\[(C^2+A^2) Z^4 + (-C^2+2AB) Z^3 + (-2AK+B^2) Z^2 - 2BKZ + K^2 = 0.\]</div>
<p>This polynomial of 4-th order can have four different solutions. From
these solutions, we have to take only the real solutions which are
larger than 0, given the range of variation of <span class="math">\(\Theta_B\)</span>:</p>
<div class="math">
\[t \in \mathbb{R}, \qquad 0 \leq t \leq 1.\]</div>
<p>Once the solutions for <span class="math">\(t\)</span> are found, we make
<span class="math">\(\Theta_B' = \arcsin t\)</span>. Note that, for a fixed value of
<span class="math">\(t\)</span>, two values of <span class="math">\(\Theta_B'\)</span> are possible. We choose the
correct one by evaluating the expressions for <span class="math">\(Q\)</span> and <span class="math">\(U\)</span>
and testing which of the two possible choices give the values equal (or
very similar) to the original ones.</p>
<p>The angles <span class="math">\((\theta_B,\phi_B)\)</span> are obtained by doing the
transformation from <span class="math">\((\Theta_B',\Phi_B)\)</span> to the vertical reference
system.</p>
</div>
<div class="section" id="id2">
<h2><span class="math">\(\Phi_B’=\Phi_B+\pi\)</span><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Under this change, we have:</p>
<div class="math">
\[\cos 2\Phi_B' = \cos 2\Phi_B, \quad \sin 2\Phi_B' = \sin 2\Phi_B, \quad \cos \Phi_B' = -\cos \Phi_B, \quad \sin \Phi_B' = -\sin \Phi_B.\]</div>
<p>Following the same approach, we have to solve for <span class="math">\(\Theta_B'\)</span> in</p>
<div class="math">
\[\left[ 3 \left( \cos \Theta_B' \cos \theta + \sin\theta \sin\Theta_B' \cos\Phi_B\right)^2-1 \right] \sin^2 \Theta_B' =
\left[ 3 \left( \cos \Theta_B \cos \theta - \sin\theta \sin\Theta_B \cos\Phi_B\right)^2-1 \right] \sin^2 \Theta_B.\]</div>
<p>The solution are obtained as the roots of the same equations as before
but now</p>
<div class="math">
\[\begin{split}\begin{aligned}
A &amp;=&amp; -3\cos^2 \theta + 3\sin^2 \theta \cos^2 \Phi_B \nonumber \\
B &amp;=&amp; 3\cos^2 \theta - 1 \nonumber \\
C &amp;=&amp; 6 \cos\theta \sin\theta \cos \Phi_B \nonumber \\
K &amp;=&amp; \left[ 3 \left( \cos \Theta_B \cos \theta - \sin\theta \sin\Theta_B \cos\Phi_B\right)^2-1 \right] \sin^2 \Theta_B.\end{aligned}\end{split}\]</div>
<p>The angles <span class="math">\((\theta_B,\phi_B)\)</span> are obtained by doing the
transformation from <span class="math">\((\Theta_B',\Phi_B+\pi)\)</span> to the vertical
reference system.</p>
</div>
<div class="section" id="id3">
<h2><span class="math">\(\Phi_B’=\Phi_B+\pi/2\)</span><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Under this change, we have:</p>
<div class="math">
\[\cos 2\Phi_B' = -\cos 2\Phi_B, \quad \sin 2\Phi_B' = -\sin 2\Phi_B, \quad \cos \Phi_B' = -\sin \Phi_B, \quad \sin \Phi_B' = \cos \Phi_B.\]</div>
<p>Following the same approach, we have to solve for <span class="math">\(\Theta_B'\)</span> in</p>
<div class="math">
\[\left[ 3 \left( \cos \Theta_B' \cos \theta + \sin\theta \sin\Theta_B' \sin\Phi_B\right)^2-1 \right] \sin^2 \Theta_B' =
\left[ 3 \left( \cos \Theta_B \cos \theta - \sin\theta \sin\Theta_B \cos\Phi_B\right)^2-1 \right] \sin^2 \Theta_B.\]</div>
<p>The solution are obtained as the roots of the same equations as before
but now</p>
<div class="math">
\[\begin{split}\begin{aligned}
A &amp;=&amp; -3\cos^2 \theta + 3\sin^2 \theta \sin^2 \Phi_B \nonumber \\
B &amp;=&amp; 3\cos^2 \theta - 1 \nonumber \\
C &amp;=&amp; 6 \cos\theta \sin\theta \sin \Phi_B \nonumber \\
K &amp;=&amp; -\left[ 3 \left( \cos \Theta_B \cos \theta - \sin\theta \sin\Theta_B \cos\Phi_B\right)^2-1 \right] \sin^2 \Theta_B.\end{aligned}\end{split}\]</div>
<p>The angles <span class="math">\((\theta_B,\phi_B)\)</span> are obtained by doing the
transformation from <span class="math">\((\Theta_B',\Phi_B+\pi/2)\)</span> to the vertical
reference system.</p>
</div>
<div class="section" id="id4">
<h2><span class="math">\(\Phi_B’=\Phi_B-\pi/2\)</span><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Under this change, we have:</p>
<div class="math">
\[\cos 2\Phi_B' = -\cos 2\Phi_B, \quad \sin 2\Phi_B' = -\sin 2\Phi_B, \quad \cos \Phi_B' = \sin \Phi_B, \quad \sin \Phi_B' = -\cos \Phi_B.\]</div>
<p>Following the same approach, we have to solve for <span class="math">\(\Theta_B'\)</span> in</p>
<div class="math">
\[\left[ 3 \left( \cos \Theta_B' \cos \theta + \sin\theta \sin\Theta_B' \sin\Phi_B\right)^2-1 \right] \sin^2 \Theta_B' =
\left[ 3 \left( \cos \Theta_B \cos \theta - \sin\theta \sin\Theta_B \cos\Phi_B\right)^2-1 \right] \sin^2 \Theta_B.\]</div>
<p>The solution are obtained as the roots of the same equations as before
but now</p>
<div class="math">
\[\begin{split}\begin{aligned}
A &amp;=&amp; -3\cos^2 \theta + 3\sin^2 \theta \sin^2 \Phi_B \nonumber \\
B &amp;=&amp; 3\cos^2 \theta - 1 \nonumber \\
C &amp;=&amp; -6 \cos\theta \sin\theta \sin \Phi_B \nonumber \\
K &amp;=&amp; -\left[ 3 \left( \cos \Theta_B \cos \theta - \sin\theta \sin\Theta_B \cos\Phi_B\right)^2-1 \right] \sin^2 \Theta_B.\end{aligned}\end{split}\]</div>
<p>The angles <span class="math">\((\theta_B,\phi_B)\)</span> are obtained by doing the
transformation from <span class="math">\((\Theta_B',\Phi_B-\pi/2)\)</span> to the vertical
reference system.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="refsys.html" class="btn btn-neutral float-right" title="The reference system" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="equations.html" class="btn btn-neutral" title="Basic Equations" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Andres Asensio Ramos.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0beta1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>